## Build base images
Build base images used by Docker Compose. 
These images should be rebuilt only if list of packages in requitements.txt changes

```bash
./build-docker-base.sh
```

## Build container images
Build container images used by Docker Compose. 
These images should be every time code changes.

```bash
./build-docker-images.sh
```

## Prepare environment file

Sample environment file is "sample.env". Rename it, add secret values and source it before executing any docker commands

```bash
source staging.env
```


## Start system

```bash
cd docker
docker-compose up
```
Look for other docker-compose commands at https://docs.docker.com/compose/reference/overview/


## One time initialization

```bash
cd docker
docker-compose exec gunicorn bash

root@2ca6ffc9967c:/starsona# ./loaddatas.sh 
Username: admin
Password: 
Password (again): 
Superuser created successfully.
Installed 19 object(s) from 1 fixture(s)
Installed 11 object(s) from 1 fixture(s)
Installed 3 object(s) from 1 fixture(s)
Installed 16 object(s) from 1 fixture(s)
Installed 18 object(s) from 1 fixture(s)
Installed 34 object(s) from 1 fixture(s)
Installed 324 object(s) from 1 fixture(s)
Installed 104 object(s) from 1 fixture(s)
r
```

## Destroy system
This command deletes all volumes, database and cached containers
```bash
cd docker
docker-compose down
```


## Notes

SSL cetificates will be generated by Let's Encrypt with "--staging" option. 
It produces untrusted certificates. If you want to produce valid SSL certificates
remove --staging option from certbot commands in nginx-entrypoint-swarm.sh